# 라우팅 프로토콜 OSPF

- 라우팅 정보를 라우터간에 공유하는 것이 아니라 라우터가 가지고있는 전체 링크 상태를 라우터간 공유하는 프로토콜이다!!

> 라우팅 프로토콜은 가장 좋은 경로를 찾는 프로토콜

## OSPF 개요

1. 각 라우터는 링크 상태에 변화가 있는 경우에만 모든 라우터에게 flooding(플러딩, 모두에게 전달)함으로써 갱신된 링크 상태 정보를 네트워크의 모든 라우터와 공유
2. 공유하는 과정이 끝나면 모든 라우터는 동일한 링크상태 정보를 가지고 있고 해당 정보로 다익스트라 알고리즘을 실행해 모든 라우터에 대한 최소 비용경로 계산
3. 최소 비용 경로 계산 결과에 따라 라우팅 테이블 갱신

> 1번에 대한 작업(해당 라우터가 알게된 링크상태정보를 모든 라우터에게 플러딩하는 작업)이 OSPF의 중요한 특징

- RIP는 30초 주기마다 자기의 라우팅 테이블을 옆 라우터에게 전달하기 때문에 굉장히 많은 라우팅 트래픽이 발생한다.
- 그에 비해 OSPF는 링크상태 변경이 되었을 때만 링크상태를 모든 라우터에게 플러딩하기 때문에 RIP에 비해 적은 라우팅 트래픽!
- 라우팅 테이블을 갱신하는 계산 시간이 RIP에 비해 적다. (위와 같은 이유)
- 매 옆 라우터에 라우팅 테이블 정보를 전달하는 RIP에 비해 플러딩 방식을 이용하는 OSPF는 링크 갱신 전파 속도가 빠르다.
- RIP와 다르게 링크 전송 속도에 따른 링크 비용에 가중치가 있어서 더 정확함.

## OSPF 동작 절차
1. 이웃 라우터가 누군지 일단 알아야하기 때문에 헬로 패킷을 주기적(10초)으로 주고받음 (이웃 관계 형성) - RIP와 비슷하게 라우팅 트래픽이 커보인다. 둘 간의 큰차이 없어보이는데 아닌가?
2. 각 라우터는 갱신된 링크 상태 정보가 포함된 LSP(Link State  Packet)또는 LSA(Link State Advertisement)를 생성
3. LSA 모든 라우터들에게 플러딩
4. 각 라우터 다익스트라 알고리즘 적용
5. 다익스트라 알고리즘의 결과로 알게된 최소 비용경로를 이용해 각 라우터는 라우팅 테이블 갱신

### DR(Designated Router)
- 네트워크에 연결된 다수의 라우터의 대표 라우터
- 플러딩할 때, 모든 라우터가 이웃 라우터들을 통해 링크상태를 전달하는게 아닌 대표 라우터 하나만 정해서 해당 대표 라우터가 이웃 라우터들을 통해 변경된 링크 상태를 전달하게 하기 위함. -> LSA를 전달하는 트래픽을 줄일 수 있다.
- 우선순위가 가장 높은 라우터를 DR라우터로 만든다.(헬로 페킷을 교환하며 선정함)

## OSPF 계층 구조

### OSPF 문제
- Intra AS 라우팅 프로토콜인 OSPF는 AS(ISP)가 커지면 플러딩으로 인한 라우팅 트래픽 증가가 되기에 문제가 있다. 각 라우터가 저장해야하는 링크 상태 정보의 양도 커진다.

### OSPF 문제 해결
- 하나의 큰 AS를 여러 영역으로 나눈다.
- 각 영역이 독립적으로 OSPF 라우팅을 수행한다.
- 영역간엔 백본 영역을 통해서 수행됨 - 백본영역? (한 AS의 여러 영역 중 대표 영역이라고 이해된다.)

## OSPF LSA/LSP

### LSA 유형
- 라우터 링크
- 네트워크 링크
- 네트워크 요약 링크
- AS 요약 링크
- 외부 링크