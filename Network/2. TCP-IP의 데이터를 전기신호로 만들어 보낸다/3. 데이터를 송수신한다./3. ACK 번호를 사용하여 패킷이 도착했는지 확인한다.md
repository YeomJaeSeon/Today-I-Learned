# ACK 번호를 사용하여 패킷이 도착했는지 확인한다.
- TCP에는 송신한 패킷이 상대에게 올바르게 도착했는지 확인하고, 도착하지 않았으면 다시 송신(retry)하는 기능이 있다.
- 그러므로 패킷을 송신한 후에는 **확인하는 동작을 한다.**

## TCP에서 송신한 패킷이 잘 도착했는지 확인하는 방법
- 시퀀스 번호(SYN): 송신할 데이터 조각의 순서 번호
- ACK: SYN + 데이터 길이 + 1 (= 다음에 전달할 시퀀스 번호)
- 데이터와 시퀀스 번호를 보내면, 상대측에선 시퀀스 번호(SYN) + 데이터 길이 + 1을 ACK 컨트롤 비트에 담아서 반송한다.
![TCP_ACK1.png](images%2FTCP_ACK1.png)
- ACK이 제대로 오지 않으면 송신한 데이터가 잘 도착하지 않았다는 것이다.
  - ex) 시컨스 번호 100과 데이터 길이가 100인 데이터를 송신했는데, 수신 측에선 ACK이 301이 왔다. 송신측은 201을 기대하고있는데, 데이터 송신에 누락이 생긴것! 그럼 송신측은 retry

## TCP의 데이터 송수신 동작은 양방향이다.
- 클라이어트에서 서버로 '요청'을 위해 데이터를 먼저 송신하긴하지만 서버도 응답할때, 클라이언트로 데이터를 송신한다. **데이터 송수신은 양방향**이다.
![TCP_ACK2.png](images%2FTCP_ACK2.png)

## ACK을 반송받기 전까지 버퍼 메모리에 송신데이터 저장
- 송신한 데이터를 수신측에서 잘 받았는지 확인을 위한 ACK이 수신될때 까지 **송신 버퍼메모리에 데이터는 보관해둔다.**
- ACK이 수신되지 않았으면 바로 다시 retry하기 위함이다.

## 웹에서 클라이언트 - 서버 요청, 응답의 데이터 송수신 실제 동작
![TCP_ACK3.png](images%2FTCP_ACK3.png)
- (1) 접속동작
  1. 클라이언트는 시퀀스 번호 초기값을 난수로 계산하여 서버로 통지한다.
  2. 서버는 클라이언트에서 받은 시퀀스 번호로부터 ACK 번호를 산출하여 클라이언트로 반송한다.(클라이언트에서 받은 시퀀스 번호 초기값도 송신실패할수있으니)
  2. 동시에 서버는 시퀀스 번호 초기값을 난수로 계산하여 클라이언트로 통지한다.
  3. 클라이언트는 서버로부터 받은 시퀀스 번호로부터 ACK번호를 산출하여 서버로 반송한다.(서버에서 받은 시퀀스 번호 초기값도 송신실패할수 있으니)
  
  - **클라이언트에서 서버로 데이터 송신을 위해, 서버에서 클라이언트 송신을 위해 각각 SYN ACK이 준비가 되었으니 데이터 송신할 준비가 되었따!!!!**
- (2) 송-수신 동작
  4. 웹의 경우엔 최초로 클라이언트에서 서버로 시퀀스 번호와 함께 데이터 송신(HTTP request message)
  5. 서버에선 HTTP reqeust message 잘받았는지 확인시켜 주기 위해 클라이언트로 ACK번호 반송
  6. 서버에선 클라이언트로 응답하기 위해 시퀀스 번호와 함께 데이터 송신(HTTP response message)
  7. 클라이언트에선 HTTP response message 잘받았는지 확인시켜 주기 위해 서버로 ACK번호 반송