# 데이터 송수신 동작의 개요

- 브라우저같은 클라이언트 어플리케이션은 DNS 서버로부터 ip주소를 알았으면 ip주소의 상대에게 웹서버의 메시지를 송신하도록 **OS의 내부에 있는 프로토콜 스택에 송신을 의뢰한다.**
    - 브라우저가 웹서버에 보내는 HTTP 메시지는 디지털 데이터이고 브라우저는 웹서버에게 디지털 데이터송신을 **OS의 프로토콜 스택에 의뢰하는**것이므로 네트워크를 통해 디지털 데이터송신을 하려는 모든 어플리케이션은 **전부 공통적으로 프로토콜 스택에 의뢰한다.**
- 네트워크를 통해 데이터를 송수신하기 위해 OS의 프로토콜스택에 의뢰하는 동작의 개요를 살펴보자.

## 데이터 송수신 동작의 개요
- DNS 서버로부터 ip를 응답받기위해 socket 라이브러리를 이용했던 것처럼, 네트워크를 통해 데이터 송수신 할때도, socket 라이브러리를 이용한다.
![1. 데이터 송수신 개요.png](images%2F1.%20%EB%8D%B0%EC%9D%B4%ED%84%B0%20%EC%86%A1%EC%88%98%EC%8B%A0%20%EA%B0%9C%EC%9A%94.png)
- 데이터 송수신하는 컴퓨터 사이에는 데이터의 통로같은 것이있다. 이를 **파이프**라고 한다.
  - 한쪽에서 데이터를 쏟으면 파이프를 통해 반대쪽에 도착하는 형태로 데이터가 전달된다. (어느쪽에서 데이터 쏟아도 상관없다. 양방향으로 데이터가 파이프를 통해 전달가능하다.)
  - 실제로는 물리적으로 파이프가 존재하진 않지만 추상적으로 파이프가 있다고 생각하자.

## 데이터 송수신을 위한 준비과정
- 위 그림을 보면 최초부터 파이프가 존재하는 것처럼 보이지만 **사실은 송 수신을 동작하기 전에 송 수신하는 양자 사이를 파이프로 연결하는 동작이 필요하다!!!!**
- 파이프 양끝에 있는 데이터 출입구가 있는데 이를 **소켓**이라고 한다.
- 데이터를 송 수신하기 전에 클라이언트는 이 소켓을 만들고 서버의 소켓과 연결하는 준비과정이 필요하다.

## 데이터 송수신 과정
1. 소켓을 만든다.
   - 서버측에는 소켓이 보통 이미 존재하고, 클라이언트가 클라이언트 측에서 소켓을 만들어 연결하길 기다린다.
2. 소켓을 연결한다.
   - 클라이언트 서버의 소켓이 서로 연결이 되면 준비가 완료된것이다.
3. 데이터를 송 수신한다.
4. 파이프를 분리하고 소켓을 말소한다.

- 이 과정에 따라 socket라이브러리 안의 프로그램을 호출하여 데이터 송 수신 동작이 실행된다.
- 이 네가지동작을 하는 것은 브라우저가 아니라 **OS 내부의 프로토콜 스택**이다.
  - 브라우저는 위 네가지 동작을 socket라이브러리를 통해 OS 내부의 프로토콜 스택에 의뢰할뿐이다. (socket라이브러리도 중개인일 뿐이다.)

### socket 라이브러리는 중개역 역할만 수행한다.
- socket라이브러리의 코드(프로그램)을 호출하여 위 네가지 데이터 송수신을 실행한다고 했지만 socket라이브러리가 실제로 데이터 송수신 네가지 과정을 실행하는게 아니다. **단순히 프로토콜 스택에 전달하는 중개역을 수행할 뿐이지 실질적인 작업은 하지 않는다.**