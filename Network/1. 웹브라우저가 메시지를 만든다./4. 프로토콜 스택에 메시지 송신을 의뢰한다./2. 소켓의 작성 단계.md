# 소켓의 작성 단계
- socket라이브러리의 프로그램을 호출하는 단계를 알아보자. (데이터 송수신 네단계에 맞춰서.)

![데이터 송수신 소켓 라이브러리 호출 단계.png](images%2F%EB%8D%B0%EC%9D%B4%ED%84%B0%20%EC%86%A1%EC%88%98%EC%8B%A0%20%EC%86%8C%EC%BC%93%20%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC%20%ED%98%B8%EC%B6%9C%20%EB%8B%A8%EA%B3%84.png)

1. 소켓을 만든다.
   - socket 라이브러리의 `socket`을 호출하기만 하면 클라이언트의 데이터 송수신을 위한 출입구인 소켓을 만들어 주라고 **프로토콜 스택에 의뢰한다.**
   - 소켓이 만들어지면 **디스크립터**라는 것이 응답된다.
     - 디스크립터란 클라이언트 호스트 하나에 여러개의 소켓이 존재할수있는데 (컴퓨터 하나에 카카오톡, 피파, 메이플스토리를 동시에 켜서 여러 파이프를 통해 데이터 송수신이 이루어지려면 소켓이 여러개 있고 구분되어야한다.) 이 소켓들을 구별하기 위한 식별자이다.
2. 소켓을 연결(접속)한다.
   - socket 라이브러리의 `connect`를 호출하여 서버측의 소켓에 연결(접속)하라고 **프로토콜 스택에 의뢰한다.**
   - `connect` 파라미터로 디스크립터, 서버의 ip주소, 포트 번호 세가지를 전달한다.
     - 디스크립터를 통해 어떤 클라이언트의 소켓을 서버의 소켓과 연결할지 프로토콜 스택에 알려줌
     - 서버의 ip주소는 당연히 네트워크에 존재하는 서버가 누군지 알기 위해서 프로토콜 스택에 알려줌
     - 포트는 서버 컴퓨터의 특정 소켓까지 지정하기 위해 프로토콜 스택에 전달함.

> ip주소는 네트워크의 존재하는 컴퓨터만 식별합니다. 컴퓨터 하나엔 여러개의 소켓이 존재하죠옹~? 그래서 서버측의 소켓까지 지정하기 위해선 포트번호가 꼬옥 필요합니다! 포트 번호가 없으면 서버측의 소켓을 지정할수 없으니 프로토콜 스택이 연결할 서버의 소켓을 알수 없겠죠!

> 클라에서 서버 소켓을 지정하기 위해 포트번호를 지정하는데.. 데이터 수신받을 떄 서버 입장에선 클라이언트의 소켓을 식별하기 위해 포트 번호를 알아야할 텐데.. -> "클라이언트에서 처음에 소켓 만들 때 프로토콜 스택이 적당한 포트번호를 할당해준다."

3. 데이터를 송수신한다.
4. 연결 끊는다.
   - 매번 연결을 끊는건 비효율적이라, HTTP 1.1에선 keep-alive header를 통한 persistence connection이 가능하다