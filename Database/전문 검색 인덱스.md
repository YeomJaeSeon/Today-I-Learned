# 전문 검색 인덱스
- `where name like %재선%;` 과 같은 쿼리는 B-Tree인덱스를 타지 않아, 쿼리성능을 높이기 위해 구글링을 하면 자주 등장하는게 '전문 검색 인덱스' 이다.
- 문서의 내용 전체를 '인덱스'화해서 특정 키워드가 포함된 문서를 검색하는 방법
  - 문서의 전체에 대한 분석과 검색을 위한 인덱싱 알고리즘

## 인덱스 알고리즘
1. 어근 분석 알고리즘
   - 검색어로 선정된 단어의 뿌리인 원형을 찾는 작업
   - 언어(영어, 한글, 일본어, 중국어..)마다 문장의 구조가 다르기에, 특정 언어에 대한 학습하는 과정이 필요한 알고리즘이다.
   - mysql서버에 적용하는건 쉽지만 '학습'이 오래걸린다.
2. n-gram 알고리즘
   - 본문을 '몇 글자'씩 잘라서 인덱싱하는 방법
   - 어근 분석 알고리즘에 비해 간단하다.
   - 그치만 인덱스의 크기는 크겠다.

-> 두 알고리즘 모두 적용하기 전에 '불용어(사용되지 않는 용어) 처리'를 한다.

## 불용어
- `select * from information_schema.INNODB_FT_DEFAULT_STOPWORD;`를 통해 mysql서버에 내장된 불용어를 확인할수있다.
- 전문검색 인덱스의 불용어를 무시하려면 `ft_stopword_file=`로 만들면 된다.
  - 사용자 정의 불용어 등록하려면 해당 파일의 value에 사용자 정의 불용어 파일 path를 입력하면 된다.
- innodb에서만 전문검색 인덱스의 불용어를 무시하려면 `SET GLOBAL inodb_ft_enable_stopword=OFF`를 이용하면 된다.(default: ON)

## 전문 검색 인덱스의 가용성
- 두가지 규칙을 지켜야함.
1. `MATCH... AGAINST` 문법을 사용해야만 전문 검색 인덱스 사용가능하다.
2. 당연하지만 전문 검색 대상 칼럼에 대한 전문 인덱스가 있어야한다. (너무 자명함)

```sql
select * from tb_test
    where MATCH(doc_body) AGAINST('재선', IN BOOLEAN MODE);
```

# 소감
- `like`절의 성능 개선을 위해 구글링하며 많이 본, 전문검색인덱스이다. 실제로 사용해본적은없다. 다른 B-Tree인덱스 키와 멀티칼럼 인덱스도 안될것이고,.. 큰 본문에 특정단어로 검색하는 기능을 만들어야할때 적용해봄직하다.
    - 특정 칼럼이 html이나 긴 소설 같은 내용이 있을때, 특정 키워드로 해당 본문을 빠르게 검색하기 위해서, 전문검색 인덱스(ngram이 간단해서 이거 쓸듯하다.)를 사용하지 않을까?