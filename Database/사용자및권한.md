# 60page~65page

### 3.3.1 고수준 비밀번호

- 비밀번호 정책은 크게 다음 3가지중에서 선택가능
    - LOW - 비밀번호 길이만 검증
        - 시스템 변수중 `validate_password.length`
    - MEDIUM - 길이, 숫자, 대소문자, 특수문자 배합 (default)
        - `validate_password.mixed_case_count`, `validate_password.number_count`, …
    - STRONG - MEDIUM + 금칙어 포함되었는지 여부 (비밀번호가 금칙어 블랙리스트에 포함되었는지.) (종종 너무 쉽거나, 시스템에 변수와 중복되거나 하는 비밀번호가 금칙어가 되나봐.)
        - `validate_password.dictionary_file`
        - mysql은 1234같은 쉽고 연속된 비번도 설정가능, 그러나 `validate_password.dictionary_file` 시스템 변수에 금칙어를 지정가능 → 텍스트파일로 작성하면됨
            - 너무 오래걸리니 이미 만들어진 파일 사용하면좋다. (사람들이 사용하는.) ([https://github.com/danielmiessler/SecLists/blob/master/Passwords/Common-Credentials/10k-most-common.txt](https://github.com/danielmiessler/SecLists/blob/master/Passwords/Common-Credentials/10k-most-common.txt))
            
            ```sql
            SET GLOBAL validate_password.dictionary_file='prohibitive_word.data';
            ```
            
        - 금칙어 파일준비하면 등록하면되는데, STRONG 정책에서만 적용되므로 정책을 설정하는 시스템변수인 `validate_password.policy` 에 STRONG으로 먼저 설정하자
            
            ```sql
            SET GLOBAL validate_password.policy='STRONG';
            ```
            

### 3.3.2 이중 비밀번호

- 하나의 데이터베이스 서버를 여러 클라이언트 서버가 접속해서 사용하기 때문에, **하나의 데이터베이스 서버 계정을 여러 군데서 사용하는 경우가 잦다**
    - 그렇기에 디비 서버 계정 비번 변경이 어려웠따.
    - 특히 서비스가 실행중인 상태에선 비번 변경이 더 어려웠다. (데이터베이스 서버를 잠시 멈추고 계정 비번을 변경해야 하기 때문..?!)
    
    → 그래서 비번 변경을 거의 못하는 경우가 잦다. (해당 계정에 대한 비번을 변경하려면 디비 서버 서비스를 멈춰야하나보다. →  보안에 취약.)
    
- Mysql 8.0버전 부턴, 비밀번호로 2개의 값을 동시에 사용할수 있는 기능 추가됨.
    - →이를 “이중 비밀번호”라고한다. (Dual Password로 메이플스토리 2차 비밀번호 같은 의미가 아니다. 오해하지말자. 2개중 하나만 일치하면 디비 서버에 로그인이 되는것을 “이중 비밀번호”라고 한다.)
    - 이중비밀번호는 하나의 계정에 두개의 비번설정가능!
        - Primary(최근에 설정된 비번), Secondary(이전의 비밀번호)로 구분됨.
    - 기존 비밀번호 변경 구문에 `RETAIN CURRENT PASSWORD` 옵션만 추가하면됨!
    
    ```sql
    alter user 'root'@'localhost' identified by 'old_password';
    alter user 'root'@'localhost' identified by 'new_password' retain current password;
    
    ```
    
    - Primary: new_password
    - Secondary: old_password
        - root계정에 이중 비밀번호 생성완료!
        - 두 비번중 아무거나 입력해서 root@localhost계정으로 디비서버에 접속가능! (신기방기)
- 이렇게 이중비번을 생성하고, 해당 계정을 통해 디비 서버에 접속하는 서버들을 순차적으로 비번변경한뒤 다시 배포하면된다.
    - 계정변경을 위해 디비서버 중단할필요가 없다!
    - 그치만, 이중비번을 설정하고 모두 비번 변경한뒤, Secondary 비번 삭제를 잊지못하면 비번 두개라 오히려 더 보안에 안좋을 수도?
    
    ```sql
    alter user 'root'@'localhost' discard old password;
    ```
    

## 3.4 권한(Privilege)

- 5.7버전 까진, 권한은 (글로벌 권한과 객체단위의 권한)으로 구분되었다.
    - 글로벌 권한: 데이터베이스나 테이블 이외의 객체에 적용되는 권한
    - 객체 권한: 데이터베이스나 테이블을 제어하는데 필요한 권한
- 객체권한은 `GRANT` 명령어로 권한 부여할때, 반드시 특정 객체를 명시해야한다.
    - 글로벌 권한은 “특정 객체를 명시하지 않아야 한다” (안해도되는게 아니라 명시하면 안된다?)
- 예외적으로 `ALL` 은 글로벌, 객체 권한 두 가지 모두로 용도로 사용될 수 있다.
    - 특정 객체에 `ALL` 권한이 부여되면 해당 객체에 적용될수 있는 모든 객체 권한 부여
    - 글로벌로 `ALL` 권한이 부여되면 글로벌 수준에서 가능한 모든 권한 부여